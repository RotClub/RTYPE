<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>R-TYPE</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">R-TYPE</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p><strong>R-TYPE</strong> is a 2D side-scrolling shoot 'em up game. The player controls a spaceship that can move horizontally and vertically. The game is divided into several levels, each with a boss at the end. The player must defeat the boss to progress to the next level. The player can collect power-ups to upgrade their ship's weapons and shields. The player must avoid or destroy enemy ships and projectiles to survive.</p>
<h2 id="what-we-made"><a class="header" href="#what-we-made">What we made</a></h2>
<p>In the context of EPITECH, we had to implement this project with some added features.</p>
<ul>
<li>Fully fledged engine with a Node System</li>
<li>Socket system with TCP and UDP</li>
<li>LUAU Virtual Machine</li>
</ul>
<p>The engine in itself makes 2 executables, a <code>server</code> and a <code>client</code>, the server on launch selects a game from a bunch of available games (either via launch arguments or selection if multiple games are available)</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rfc"><a class="header" href="#rfc">RFC</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="building"><a class="header" href="#building">Building</a></h1>
<p>The engine is a shared library that is used by the server and the client.
The server and the client are two separate executables that use the engine library.
You can build all the project with the following command:</p>
<pre><code class="language-bash">./build.sh release
</code></pre>
<p>This command will build the engine, the server and the client in release mode.
The executables will be at the root of the project.</p>
<p>You can also build the engine, the server and the client separately with the following commands:</p>
<pre><code class="language-bash">./build.sh release engine
./build.sh release server
./build.sh release client
</code></pre>
<p>This will build the engine, the server or the client in release mode.</p>
<p>You can also build the project in debug mode with the following command:</p>
<pre><code class="language-bash">./build.sh debug
</code></pre>
<p>or</p>
<pre><code class="language-bash">./build.sh debug engine
./build.sh debug server
./build.sh debug client
</code></pre>
<p>This will build the engine, the server or the client in debug mode.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="server"><a class="header" href="#server">Server</a></h1>
<p>The server is responsible of managing the game state and the communication between the clients and the game.
When the server is started, it will start the game engine and the connection manager.
It run on the port "25777" by default but it can be changed with the <code>--port</code> option.
The server can use two types of connection: TCP and UDP.</p>
<p>The command to run the server is:</p>
<pre><code class="language-bash">./r-type_server
</code></pre>
<p>or with the port option:</p>
<pre><code class="language-bash">./r-type_server --port 12345
</code></pre>
<h2 id="tcp-connection"><a class="header" href="#tcp-connection">TCP Connection</a></h2>
<p>The TCP connection is used to do the initial handshake between the client and the server.
The client will send a message to the server to ask to join the game.
The server will then send a message to the client to tell him if he can join the game or not.
If the client can join the game, the server will send the game state to the client.</p>
<p>It is also used ...</p>
<h2 id="udp-connection"><a class="header" href="#udp-connection">UDP Connection</a></h2>
<p>The UDP connection is used to send the game state to the clients.
The server will send the game state to all the clients at a fixed rate.
The client will then update the game state and render it and send the input to the server.</p>
<p>It is also used ...</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client"><a class="header" href="#client">Client</a></h1>
<p>The client runs the game and is responsible for rendering the game state and sending the input to the server.</p>
<p>The client is written in C++ and uses the Raylib library to render the game.</p>
<p>The client can be run with the following command:</p>
<pre><code class="language-bash">./r-type_client
</code></pre>
<p>The client can be run with the following options:</p>
<ul>
<li><code>--ip</code> to specify the server IP address</li>
<li><code>--port</code> to specify the server port</li>
</ul>
<p>The client can use two types of connection: TCP and UDP.</p>
<h2 id="tcp-connection-1"><a class="header" href="#tcp-connection-1">TCP Connection</a></h2>
<p>The TCP connection is used to do the initial handshake between the client and the server.
The client will send a message to the server to ask to join the game.
The server will then send a message to the client to tell him if he can join the game or not.
If the client can join the game, the server will send the game state to the client.</p>
<p>It is also used ...</p>
<h2 id="udp-connection-1"><a class="header" href="#udp-connection-1">UDP Connection</a></h2>
<p>The UDP connection is used to send the input to the server.
The client will send the input to the server at a fixed rate.
The server will then update the game state and send it to the client.</p>
<p>It is also used ...</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="games-filesystem"><a class="header" href="#games-filesystem">Games Filesystem</a></h1>
<p>Each game is put in the <code>games/</code> folder. The directory architecture is strict and must be followed as such:</p>
<p><em>Files/Folders in <strong>bold</strong> are required for the project to be valid.</em></p>
<ul>
<li><strong>manifest.json</strong></li>
<li>assets/</li>
<li><strong>lua/</strong>
<ul>
<li><strong>index.lua</strong> <em>entrypoint for every game</em></li>
</ul>
</li>
</ul>
<h2 id="manifestjson"><a class="header" href="#manifestjson">manifest.json</a></h2>
<p>The manifest file is used for the server to know the presence of a valid game and retrieve basic information to send to the players on join attempts.</p>
<pre><code class="language-json">{
    "name": "string",
    "description": "string",
    "max_players": 4,
    "authors": ["string", "string"],
    "version": 1.0
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="luau"><a class="header" href="#luau">LUAU</a></h1>
<p>The engine uses <a href="https://luau.org/">LUAU</a> for game scripting.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="libraries"><a class="header" href="#libraries">Libraries</a></h1>
<p>The engine makes use of multiple libraries to get the job done, some of those come from native LUAU.</p>
<p>They can be found in the LUAU documentation:</p>
<ul>
<li><a href="https://luau.org/library#global-functions">Global functions</a></li>
<li><a href="https://luau.org/library#math-library">math</a></li>
<li><a href="https://luau.org/library#table-library">table</a></li>
<li><a href="https://luau.org/library#string-library">string</a></li>
<li><a href="https://luau.org/library#coroutine-library">coroutine</a></li>
<li><a href="https://luau.org/library#bit32-library">bit32</a></li>
<li><a href="https://luau.org/library#utf8-library">utf8</a></li>
<li><a href="https://luau.org/library#os-library">os</a></li>
<li><a href="https://luau.org/library#debug-library">debug</a></li>
<li><a href="https://luau.org/library#buffer-library">buffer</a></li>
<li><a href="https://luau.org/library#vector-library">vector</a></li>
</ul>
<h2 id="custom-libraries"><a class="header" href="#custom-libraries">Custom libraries</a></h2>
<p>We also implemented our own set of libraries to make controlling the engine easier.</p>
<ul>
<li><a href="game/libs.html#hook-library">hook</a> - Assign logic that needs to be triggered on specific events.</li>
<li><a href="game/libs.html#json-library">json</a> - JSON Parser and Serializer.</li>
<li><a href="game/libs.html#utils-library">utils</a> - Set of functions that accomplish all sorts of stuff.</li>
</ul>
<hr />
<h2 id="hook-library"><a class="header" href="#hook-library">Hook library</a></h2>
<p>This library is used to create events and assign logic to them.</p>
<h3 id="hookadd"><a class="header" href="#hookadd">hook.Add</a></h3>
<p>Adds a hook to the global hook table.</p>
<h4 id="prototype"><a class="header" href="#prototype">Prototype</a></h4>
<pre><code class="language-luau">hook.Add(eventName: string, hookName: string, callback: (...any) -&gt; any)
</code></pre>
<h4 id="arguments"><a class="header" href="#arguments">Arguments</a></h4>
<ul>
<li><code>eventName: string</code> Name of the event.</li>
<li><code>hookName: string</code> Name of the hook.</li>
<li><code>callback: (...any) -&gt; any</code> Callback function that will be executed when the event is triggered.</li>
</ul>
<h4 id="example"><a class="header" href="#example">Example</a></h4>
<pre><code class="language-lua">hook.Add("RType:InitServer", "hello_name", function(name: string)
    print("Hello " .. name)
end)
</code></pre>
<h3 id="hookremove"><a class="header" href="#hookremove">hook.Remove</a></h3>
<p>Removes a hook from the global hook table</p>
<h4 id="prototype-1"><a class="header" href="#prototype-1">Prototype</a></h4>
<pre><code class="language-luau">hook.Remove(eventName: string, hookName: string)
</code></pre>
<h4 id="arguments-1"><a class="header" href="#arguments-1">Arguments</a></h4>
<ul>
<li><code>eventName: string</code> Name of the event the hook is stored in.</li>
<li><code>hookName: string</code> Name of the hook to be deleted.</li>
</ul>
<h4 id="example-1"><a class="header" href="#example-1">Example</a></h4>
<pre><code class="language-lua">hook.Remove("RType:InitServer", "hello_name")
</code></pre>
<h3 id="hookcall"><a class="header" href="#hookcall">hook.Call</a></h3>
<p>Calls all hooks under the eventName</p>
<h4 id="prototype-2"><a class="header" href="#prototype-2">Prototype</a></h4>
<pre><code class="language-luau">hook.Call(eventName: string, ...)
</code></pre>
<h4 id="arguments-2"><a class="header" href="#arguments-2">Arguments</a></h4>
<ul>
<li><code>eventName: string</code> Name of the event under which all hooks will get triggered.</li>
<li><code>...</code> Varargs, represent all arguments that will be passed to each hook's callback.</li>
</ul>
<hr />

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
